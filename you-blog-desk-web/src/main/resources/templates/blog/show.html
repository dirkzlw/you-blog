<!doctype html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/blog/lib/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="/blog/css/main.css">
    <link rel="stylesheet" href="/blog/css/animate.css">
    <link rel="stylesheet" href="/blog/css/font-icon.css">
    <title>友博网</title>
</head>
<body>
<!--头部-->
<div th:replace="~{fragments/header :: header}"></div>

<!--内容-->
<div class="container mt-3">
    <div class="row">
        <div class="col-md-8">
            <div class="container">

                <div class="row mt-2">
                    <div class="col-md-12 bgc">
                        <div class="new">
                            <span th:text="${blog.title}"></span>
                        </div>
                    </div>
                </div>

                <div class="row mt-2">
                    <div class="col-md-12 bgc">
                        <div class="article-title">
                            <ul>
                                <li title="编辑时间"><a><i class="el-time"></i><span th:text="${blog.createTime}"></span></a></li>
                                <li title="作者" style="position:relative;left: 20px;" class="d-none d-sm-none d-md-none d-lg-block">
                                    <a><i class="el-user"></i>
                                        <span th:text="${blog.user.username}"></span></a></li>
                                <li style="position:relative;left: 40px;cursor: pointer" onclick="zan()" title="点赞">
                                    <a><i class="el-heart"></i>
                                        <span th:text="${blog.zanNum}" id="zanNum"></span></a></li>
                                <li title="访问量" style="position:relative;left: 60px;"><a><i class="el-eye-open"></i>
                                    <span th:text="${blog.viewNum}"></span></a></li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="row mt-2 bgc">
                    <div class="article-body" th:utext="${blog.content}"></div>
                </div>
            </div>
        </div>

        <!--右边-->
        <div th:replace="~{fragments/right :: right}"></div>
    </div>
</div>

<!--底部-->
<div th:replace="~{fragments/footer :: footer}"></div>

<!--隐藏的input-->
<input type="hidden" id="blogId" th:value="${blog.blogId}">

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="/blog/lib/jquery/jquery.js"></script>
<script src="/blog/lib/bootstrap/js/bootstrap.js"></script>
<script src="/blog/js/wow.js"></script>
<!--layui-->
<script src="/layui/layui.js" charset="utf-8"></script>
<script>
    new WOW().init();//把wow初始化
</script>
<script type="text/javascript">
    //添加弹出层
    layui.use(['layer'], function () {
        $ = layui.jquery;//jquery
        layer = layui.layer;//弹出层

    });

    //点赞
    function zan() {
        var blogId = $("#blogId").val();
        $.ajax({
            type: "POST",
            url: "/blog/zan",
            data: {'blogId': blogId},
            dataType: "text",
            success: function (json) {
                if (json == "success") {
                    layer.msg("谢谢您的赞❥(^_-)", {icon: 6, time: 1000});
                    //更新赞的数量
                    var zanNumObj = $("#zanNum");
                    var zanNum = Number(zanNumObj.text());
                    zanNumObj.text(zanNum + 1);

                } else {
                    layer.msg("点赞失败，请检查网络!", {icon: 5, time: 1000});
                }
            },
            error: function (json) {
                narn('warn', '点赞失败，请检查网络!');
                return false;
            }
        });
    }
</script>
</body>
</html>