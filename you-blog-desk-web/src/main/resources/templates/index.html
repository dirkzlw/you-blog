<!doctype html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="blog/lib/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="blog/css/main.css" media="all">
    <link rel="stylesheet" href="blog/css/animate.css">
    <link rel="stylesheet" href="blog/css/font-icon.css">
    <!--返回顶部-->
    <link href="/back-to-top/css/style.css" rel="stylesheet" type="text/css"/>
    <title>个人博客</title>
</head>
<body>
<!--头部-->
<div th:replace="~{fragments/header :: header}"></div>

<!--内容-->
<div class="container mt-3">
    <div class="row">
        <div class="col-md-8">
            <div class="container">
                <!--轮播图-->
                <div class="row wow fadeInDown">
                    <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                        <ol class="carousel-indicators">
                            <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                            <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                            <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                        </ol>
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <img src="blog/images/banner_1.jpg" class="d-block w-100" alt="...">
                            </div>
                            <div class="carousel-item">
                                <img src="blog/images/banner_2.jpg" class="d-block w-100" alt="...">
                            </div>
                            <div class="carousel-item">
                                <img src="blog/images/banner_3.jpg" class="d-block w-100" alt="...">
                            </div>
                        </div>
                        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button"
                           data-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button"
                           data-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                </div>
                <!--文章列表 头部-->
                <div class="row mt-2 wow fadeInDown">
                    <div class="col-md-12 bgc">
                        <div class="new">
                            <span><i class="el-certificate"></i></span>

                            <span>最新文章</span>
                            <small>New Article</small>
                        </div>
                    </div>
                </div>
                <!--文章列表 内容-->
                <div class="row mt-2 " id="blog-content">

                    <ul class="list-unstyled art-list" th:each="blog,var : ${blogPage.content}">
                        <li th:if="${var.count} % 2 eq 1 "
                            class="media wow bounceInLeft" data-wow-duration="1s" data-wow-delay="0.5s">
                            <div class="art-img">
                                <img class="mr-3" th:src="${blog.coverImgUrl}" alt="Generic placeholder image">
                            </div>
                            <div class="media-body art-content">
                                <h5 class="mt-0 mb-1"><a th:id="${blog.blogId}"
                                                         th:text="${blog.title}"
                                                         onclick="showBlog(this.id)"></a></h5>
                                <p th:text="${blog.text}"></p>
                                <ul>
                                    <li><a><i class="el-time"></i><span th:text="${blog.createTime}"></span></a></li>
                                    <li class="d-none d-sm-none d-md-none d-lg-block">
                                        <a href="./article.html"><i class="el-user"></i>
                                            <span th:text="${blog.user.username}"></span></a></li>
                                    <li><a><i class="el-heart"></i><span th:text="${blog.zanNum}"></span></a></li>
                                    <li><a><i class="el-eye-open"></i><span th:text="${blog.viewNum}"></span></a></li>
                                    <li class="d-none d-sm-none d-md-none d-lg-block">
                                        <a href="./article.html" ><i
                                                class="el-th-list"></i><span th:text="${blog.tag.type}"></span></a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        <li th:if="${var.count} % 2 eq 0 "
                            class="media wow bounceInRight" data-wow-duration="1s" data-wow-delay="0.5s">
                            <div class="art-img">
                                <img class="mr-3" th:src="${blog.coverImgUrl}" alt="Generic placeholder image">
                            </div>
                            <div class="media-body art-content">
                                <h5 class="mt-0 mb-1"><a th:id="${blog.blogId}"
                                                         th:text="${blog.title}"
                                                         onclick="showBlog(this.id)"></a></h5>
                                <p th:text="${blog.text}"></p>
                                <ul>
                                    <li><a><i class="el-time"></i><span th:text="${blog.createTime}"></span></a></li>
                                    <li class="d-none d-sm-none d-md-none d-lg-block">
                                        <a href="./article.html"><i class="el-user"></i>
                                            <span th:text="${blog.user.username}"></span></a></li>
                                    <li><a><i class="el-heart"></i><span th:text="${blog.zanNum}"></span></a></li>
                                    <li><a><i class="el-eye-open"></i><span th:text="${blog.viewNum}"></span></a></li>
                                    <li class="d-none d-sm-none d-md-none d-lg-block"><a
                                            href="/index/article/index/id/32.html" ><i
                                            class="el-th-list"></i><span th:text="${blog.tag.type}"></span></a></li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="row" id="bottom">

                </div>
            </div>
        </div>

        <!--右边-->
        <div class="col-md-4 ">
            <div class="container">
                <!--用户信息-->
                <div th:if="${session.user} ne null" class="row bgc mt-5 right-author">
                    <div class="col-md-12 ">
                        <div class="auth-img">
                            <img src="blog/images/logo.png" alt="">
                        </div>
                        <div class="auth-name">
                            <span>惜缘</span>
                        </div>
                        <div class="auth-info">
                            <ul>
                                <li><strong>2</strong><span>原创</span></li>
                                <li><strong>2</strong><span>转发</span></li>
                                <li><strong>2</strong><span>翻译</span></li>
                            </ul>
                        </div>

                    </div>
                </div>
                <!--搜索-->
                <div class="row bgc mt-3">
                    <div class="search">
                        <input type="hidden" id="page" th:value="${blogPage.page}">
                        <input type="hidden" id="pageSize" th:value="${blogPage.pageSize}">
                        <input type="hidden" id="totalElements" th:value="${blogPage.totalElements}">
                        <input type="text" id="search" th:value="${search}" class="search-input" placeholder="博客标题">
                        <button class="search-submit" onclick="blogSearch()"></button>
                        <i class="el-search"></i>
                    </div>

                </div>

                <!--网站公告-->
                <div class="row bgc mt-4">
                    <div class="new new-right">
                        <span><i class="el-arrow-up"></i></span>
                        <span>网站公告</span>
                        <small>Notice</small>
                    </div>
                    <div class="col-md-12 ">
                        <div class="notice">
                            <ul>
                                <li th:each="notice : ${noticeList}" th:text="${notice.info}"></li>
                            </ul>
                        </div>

                    </div>
                </div>
                <!--博客标签-->
                <div class="row bgc mt-5">
                    <div class="new new-right">
                        <span><i class="el-tags"></i>博客标签</span>
                        <small>Blog Tag</small>
                    </div>
                    <div class="col-md-12 ">
                        <ul class="label">
                            <li th:each="tag : ${tagList}">
                                <a href="#" th:text="${tag.type}+' ('+${tag.blogList.size()}+') '"></a>
                            </li>
                        </ul>
                    </div>
                </div>

                <!--今日推荐-->
                <div class="row bgc mt-4">
                    <div class="new new-right">

                        <span><i class="el-asl"></i>今日推荐</span>
                        <small>Recommender</small>
                    </div>
                    <ul class="list-unstyled artimg-list">
                        <li class="media">
                            <div class="artimg-img">
                                <img class="mr-3" src="blog/images/eg.png" alt="Generic placeholder image">
                            </div>
                            <div class="media-body art-content">
                                <h5 class="mt-0 mb-1">js前端实现模糊查询</h5>
                                <p>js前端实现模糊查询对于模糊查询，一般都是传关键字给后端</p>
                                <ul>
                                    <li><a title="惜缘2019-04-03发表"><i class="el-time"></i>2019-04-03</a></li>
                                    <li class="d-none d-sm-none d-md-none d-lg-block"><a
                                            href="/index/article/index/id/32.html" ><i class="el-fire"></i>5</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                    </ul>

                </div>

                <!--排行榜+热门文章-->
                <div class="row bgc mt-5">

                    <div class="nav nav-tabs tab-atr" id="box" role="tablist">
                        <a class="nav-item  active actives" id="nav-home-tab" data-toggle="tab" href="#nav-home"
                           role="tab" aria-controls="nav-home" aria-selected="true">排行榜</a>
                        <a class="nav-item " id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab"
                           aria-controls="nav-profile" aria-selected="false">文章排行</a>
                    </div>

                    <div class="tab-content" id="nav-tabContent">
                        <div class="tab-pane fade show active" id="nav-home" role="tabpanel"
                             aria-labelledby="nav-home-tab">
                            <ul class="hd-ul">
                                <li>
                                    <div class="art-hd-list-left">
                                        <a href="#"><img src="blog/images/logo.png" alt=""></a>
                                    </div>
                                    <div class="art-hd-list-right">
                                        <span><i class="el-user"></i>惜缘</span>
                                        <time>2020-3-7</time>
                                        <p>一般都是传关键字给后端，由后端来做...</p>
                                    </div>
                                </li>

                            </ul>
                        </div>
                        <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
                            <ul class="art-sort">
                                <li>
                                    <span>1</span>
                                    <a href="#">thinkphp5随机抽取数据的方法
                                        <b>(235)</b>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!--友情链接-->
                <div class="row bgc mt-5">
                    <div class="new new-right">
                        <span><i class="el-paper-clip"></i>友情连接</span>
                        <small>Friend Links</small>
                    </div>
                    <div class="col-md-12 ">
                        <ul class="links">
                            <li><a href="https://www.baidu.com/">百度一下</a></li>
                            <li><a href="https://www.yonyou.com/">企业官网</a></li>
                            <li><a href="https://github.com/dirkzlw/you-blog">GitHub</a></li>
                            <li><a href="">You Blog Api</a></li>
                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!--返回顶部-->
    <div class="suspension">
        <a class="consult" target="_blank" title="在线客服">
            <div class="suspension-list" style="display:none;">
                <div class="suspension-list-content">
                    <ul>
                        <li>
                            <div href="javascript:;" class="service-phone">
                                <span class="info-name">客服热线</span>
                                <span class="info-value">400-888-8888</span>
                            </div>
                        </li>
                        <li>
                            <div href="javascript:;" class="service-qq">
                                <span class="info-name">在线客服</span>
                                <span class="info-value">800991234</span>
                            </div>
                        </li>
                        <li class="suspension-list-bottom">
                            <div href="javascript:;" class="service-proposal">
                                <span class="info-name">投诉与建议</span>
                                <span class="info-value">最快10分钟内回应</span>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </a>
        <a class="cart" title="关注微信公众号">
            <div class="pic">
                <div class="pic-content"
                     th:style="'background:url(' + ${attentionImgUrl} + ') center no-repeat ;background-size :139px 169px;'"></div>
            </div>
        </a>
        <a href="javascript:void(0)" onclick="toTop()" class="back-top" style="display: block;" title="返回顶部"></a>
    </div>
</div>

<!--底部-->
<div th:replace="~{fragments/footer :: footer}"></div>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="blog/lib/jquery/jquery.js"></script>
<script src="blog/lib/bootstrap/js/bootstrap.js"></script>
<script src="blog/js/wow.js"></script>
<script type="text/javascript">

    /**
     * 展示某博客
     */
    function showBlog(id) {
        window.open("/blog/show?blogId=" + id, "_self");
    }

    /**
     * 检索博客
     */
    function blogSearch() {
        var search = $("#search").val();
        window.open("/?search=" + search, "_self");
    }

    /**
     * 监听滚动条
     */
    $(window).scroll(function () {
        //滚动条所在位置的高度
        totalheight = parseFloat($(window).height()) + parseFloat($(window).scrollTop());
        //当前文档高度   小于或等于   滚动条所在位置高度  则是页面底部
        if (($(document).height()) <= totalheight + 1) {
            //滚动条到底加载新的数据
            var search = $("#search").val();
            var page = $("#page").val() * 1.0 + 1;
            $.ajax({
                type: "POST",
                url: "/blog/more",
                data: {'page': page, 'search': search},
                dataType: "text",
                success: function (json) {
                    //解析json
                    json = eval('(' + json + ')');
                    var content = json.content;
                    var page = json.page;
                    debugger;
                    if (content.length == 0){
                        var totalElements = Number($("#totalElements").val());
                        var pageSize = Number($("#pageSize").val());
                        if(Math.ceil(totalElements/pageSize) == page){
                            //底部代码
                            var htmlStr = "<div class='col-md-12 bgc'>" +
                                "                        <div class='new'>" +
                                "                            <span><i class='el-certificate'></i>已经到底了~</span>" +
                                "                        </div>" +
                                "                    </div>";
                            $("#bottom").html(htmlStr);
                        }
                        return;
                    }
                    //拼接html
                    var htmlUl1 = "<ul class='list-unstyled art-list'>";
                    var htmlUl2 = "</ul>";
                    for (var i = 0; i < content.length; i+=2) {
                        var htmlStr = "                        <li class='media wow bounceInLeft' data-wow-duration='1s' data-wow-delay='0.5s'>" +
                            "                            <div class='art-img'>" +
                            "                                <img class='mr-3' src=" + content[i].coverImgUrl + " alt='Generic placeholder image'>" +
                            "                            </div>" +
                            "                            <div class='media-body art-content'>" +
                            "                                <h5 class='mt-0 mb-1'><a href='#' id='" + content[i].blogId + "' onclick='showBlog(this.id)'>" + content[i].title + "</a></h5>" +
                            "                                <p>" + content[i].text + "</p>" +
                            "                                <ul>" +
                            "                                    <li><a><i class='el-time'></i><span>" + content[i].createTime + "</span></a></li>" +
                            "                                    <li class='d-none d-sm-none d-md-none d-lg-block'>" +
                            "                                        <a href='#'><i class='el-user'></i>" +
                            "                                            <span>" + content[i].username + "</span></a></li>" +
                            "                                    <li><a><i class='el-heart'></i><span>" + content[i].zanNum + "</span></a></li>" +
                            "                                    <li><a><i class='el-eye-open'></i><span>" + content[i].viewNum + "</span></a></li>" +
                            "                                    <li class='d-none d-sm-none d-md-none d-lg-block'>" +
                            "                                        <a href='#' title='查看分类'><i" +
                            "                                                class='el-th-list'></i><span>" + content[i].tag + "</span></a></li>" +
                            "                                </ul>" +
                            "                            </div>" +
                            "                        </li>";
                        if (i + 1 < content.length) {
                            htmlStr += "                        <li class='media wow bounceInRight' data-wow-duration='1s' data-wow-delay='0.5s'>" +
                                "                            <div class='art-img'>" +
                                "                                <img class='mr-3' src=" + content[i+1].coverImgUrl + " alt='Generic placeholder image'>" +
                                "                            </div>" +
                                "                            <div class='media-body art-content'>" +
                                "                                <h5 class='mt-0 mb-1'><a href='#' id='" + content[i+1].blogId + "' onclick='showBlog(this.id)'>" + content[i+1].title + "</a></h5>" +
                                "                                <p>" + content[i+1].text + "</p>" +
                                "                                <ul>" +
                                "                                    <li><a><i class='el-time'></i><span>" + content[i+1].createTime + "</span></a></li>" +
                                "                                    <li class='d-none d-sm-none d-md-none d-lg-block'>" +
                                "                                        <a href='#'><i class='el-user'></i>" +
                                "                                            <span>" + content[i+1].username + "</span></a></li>" +
                                "                                    <li><a><i class='el-heart'></i><span>" + content[i+1].zanNum + "</span></a></li>" +
                                "                                    <li><a><i class='el-eye-open'></i><span>" + content[i+1].viewNum + "</span></a></li>" +
                                "                                    <li class='d-none d-sm-none d-md-none d-lg-block'>" +
                                "                                        <a href='#' title='查看分类'><i" +
                                "                                                class='el-th-list'></i><span>" + content[i+1].tag + "</span></a></li>" +
                                "                                </ul>" +
                                "                            </div>" +
                                "                        </li>"
                        }
                        $("#blog-content").append(htmlUl1 + htmlStr + htmlUl2);
                    }
                    $("#page").attr("value", page);
                },
                error: function () {
                    layer.msg('添加失败，请检查网络!', {icon: 5, time: 1000});

                }
            });
        }
    });

    /**
     * 监听返回顶部
     */
    $(function () {
        $(".back-top").hide();
        $(window).bind('scroll resize', function () {
            if ($(window).scrollTop() <= 400) {
                $(".back-top").hide();
            } else {
                $(".back-top").show();
            }
        })
    });

    //回到顶部
    function toTop() {
        $('html, body').animate({
            scrollTop: 0
        }, 400);
        return false;
    }
</script>
<script>
    new WOW().init();//把wow初始化

</script>
<script>
    window.onload = function () {
        var art_list = document.getElementById('box');
        var art_list_a = art_list.getElementsByTagName('a');

        for (var i = 0; i < art_list_a.length; i++) {

            var aclick = art_list_a[i];

            aclick.onclick = function () {

                for (var j = 0; j < art_list_a.length; j++) {
                    art_list_a[j].className = '';
                    art_list_a[j].style.color = '#000000';
                }
                this.className = 'actives';
                this.style.color = '#ffffff';
            };
        }
    }
</script>
</body>
</html>